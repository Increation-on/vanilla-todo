/**
 * üõ°Ô∏è –ú–ï–ù–ï–î–ñ–ï–† –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Å–µ—Å—Å–∏—è–º–∏
 * 
 * –û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:
 * - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
 * - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–≤—Ö–æ–¥) —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
 * - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏—è–º–∏ (–ª–æ–≥–∏–Ω/–ª–æ–≥–∞—É—Ç)
 * - –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ localStorage
 * 
 * –ê–†–•–ò–¢–ï–ö–¢–£–†–ê: 
 * - Stateless (–Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞–º–∏)
 * - –í—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ localStorage
 * - –ß–∏—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–∫—Ä–æ–º–µ side effects –≤ localStorage)
 */

export const AuthManager = {
    
    /**
     * üìã –ü–û–õ–£–ß–ï–ù–ò–ï –°–ü–ò–°–ö–ê –í–°–ï–• –ó–ê–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–ù–ù–´–• –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô
     * 
     * –ü–†–ò–ù–¶–ò–ü: –í—Å–µ–≥–¥–∞ –±–µ—Ä–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
     * –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∫–ª–∞–¥–∫–∞—Ö
     */
    getUsers() {
        return JSON.parse(localStorage.getItem('users')) || [];
    },
    
    /**
     * üìù –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ù–û–í–û–ì–û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
     * –ü–†–û–¶–ï–°–°:
     * 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ email –µ—â–µ –Ω–µ –∑–∞–Ω—è—Ç
     * 2. –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
     * 3. –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –æ–±—â–∏–π —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
     */
    register(email, password) {
        const users = this.getUsers();
        const existingUser = users.find(user => user.email === email);
        if (existingUser) {
            return false; // üö´ Email —É–∂–µ –∑–∞–Ω—è—Ç
        }
        
        const newUser = { email, password };
        users.push(newUser);
        localStorage.setItem('users', JSON.stringify(users));
        
        console.log('üìù –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:', email);
        return true; // ‚úÖ –£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
    },

    /**
     * üîê –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø (–í–•–û–î –í –°–ò–°–¢–ï–ú–£)
     * 
     * –ü–†–û–¶–ï–°–°:
     * 1. –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email –∏ –ø–∞—Ä–æ–ª—é
     * 2. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω - —Å–æ–∑–¥–∞–µ–º —Å–µ—Å—Å–∏—é
     * 3. –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å –≤—Ö–æ–¥–∞ –≤ localStorage
     */
    login(email, password) {
        const users = this.getUsers();
        const user = users.find(user => 
            user.email === email && user.password === password
        );
        
        if (user) {
            // üé™ –°–û–ó–î–ê–ï–ú –°–ï–°–°–ò–Æ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
            localStorage.setItem('isLoggedIn', 'true');
            localStorage.setItem('userEmail', email);
            return true; // ‚úÖ –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
        }
        return false; // üö´ –ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å
    },

    /**
     * üö™ –í–´–•–û–î –ò–ó –°–ò–°–¢–ï–ú–´ (–ó–ê–í–ï–†–®–ï–ù–ò–ï –°–ï–°–°–ò–ò)
     * 
     * –ü–†–û–¶–ï–°–°:
     * - –£–¥–∞–ª—è–µ–º —Ñ–ª–∞–≥–∏ —Å–µ—Å—Å–∏–∏ –∏–∑ localStorage
     * - –ù–µ —Ç—Ä–æ–≥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–æ–Ω–∏ –æ—Å—Ç–∞—é—Ç—Å—è –¥–ª—è –±—É–¥—É—â–∏—Ö –≤—Ö–æ–¥–æ–≤)
     */
    logout() {
        localStorage.removeItem('isLoggedIn');
        localStorage.removeItem('userEmail');
    },

    /**
     * üîç –ü–†–û–í–ï–†–ö–ê –°–¢–ê–¢–£–°–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò
     * 
     * –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø –î–õ–Ø:
     * - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ª–∏ —Ñ–æ—Ä–º—É –≤—Ö–æ–¥–∞ –∏–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
     * - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
     */
    isLoggedIn() {
        return localStorage.getItem('isLoggedIn') === 'true';
    }
}

// üí° –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ï –ü–†–ò–ù–¶–ò–ü–´:
// - –ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø –û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨: —Ç–æ–ª—å–∫–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Å–µ—Å—Å–∏—è–º–∏
// - –ù–ò–ó–ö–ê–Ø –°–í–Ø–ó–ê–ù–ù–û–°–¢–¨: –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç UI, —Ç–æ–ª—å–∫–æ –æ—Ç –¥–∞–Ω–Ω—ã—Ö
// - –í–°–ï–ì–î–ê –ê–ö–¢–£–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï: –∫–∞–∂–¥—ã–π —Ä–∞–∑ —á–∏—Ç–∞–µ–º –∏–∑ localStorage

// üîÆ –í–û–ó–ú–û–ñ–ù–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø:
// - –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt)
// - JWT —Ç–æ–∫–µ–Ω—ã –≤–º–µ—Å—Ç–æ —Ñ–ª–∞–≥–æ–≤ –≤ localStorage  
// - –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Å–µ—Å—Å–∏–∏
// - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è